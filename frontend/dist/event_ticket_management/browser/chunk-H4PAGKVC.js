import{b as S,e as C,f as y,g as I,h as x,i as w,p as _,s as M}from"./chunk-C7UFNYZC.js";import{Qa as n,Ra as s,X as p,Xa as m,fb as a,fc as h,jb as c,kb as g,lb as f,nb as b,ya as l,za as d}from"./chunk-A5IQK4TJ.js";import"./chunk-JHI3MBHO.js";var N=class u{constructor(t){this.http=t}issue="";apiUrl="http://localhost:5095/api/SupportTicket";submitIssue(){let t=localStorage.getItem("token");if(!t){alert("User is not logged in.");return}let e=this.decodeJwt(t);if(!e||!e.UserId){alert("Invalid user token.");return}let r={Authorization:`Bearer ${t}`};if(!this.issue.trim()){alert("Issue description is required.");return}let i={id:0,userId:e.UserId,issue:this.issue.trim(),status:"Pending",createdAt:new Date().toISOString(),user:{userId:e.UserId,username:e.Username||"unknown",passwordHash:"string",role:e.UserRole||"Customer",email:"string",phoneNumber:"string",isActive:!0}};console.log("Payload:",i),this.http.post(this.apiUrl,i,{headers:r}).subscribe({next:o=>{alert(o.message||"Issue submitted successfully."),this.issue=""},error:o=>{console.error("Error submitting issue:",o),alert("An error occurred while submitting your issue.")}})}decodeJwt(t){try{let e=t.split(".");if(e.length===3){let r=atob(e[1]);return JSON.parse(r)}}catch(e){console.error("Failed to decode JWT:",e)}return null}static \u0275fac=function(e){return new(e||u)(d(h))};static \u0275cmp=p({type:u,selectors:[["app-support"]],standalone:!0,features:[b],decls:7,vars:1,consts:[[1,"support-form"],[3,"ngSubmit"],["name","issue","placeholder","Describe your issue here...","rows","5","required","",3,"ngModelChange","ngModel"],["type","submit",1,"btn-submit"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),a(2,"Submit an Issue"),s(),n(3,"form",1),m("ngSubmit",function(){return r.submitIssue()}),n(4,"textarea",2),f("ngModelChange",function(o){return g(r.issue,o)||(r.issue=o),o}),s(),n(5,"button",3),a(6,"Submit"),s()()()),e&2&&(l(4),c("ngModel",r.issue))},dependencies:[M,w,S,C,y,_,x,I],styles:[".support-form[_ngcontent-%COMP%]{padding:20px;max-width:500px;margin:auto}textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:5px;border:1px solid #ccc}button.btn-submit[_ngcontent-%COMP%]{margin-top:10px;background-color:#ff6f61;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer}"]})};export{N as SupportComponent};
